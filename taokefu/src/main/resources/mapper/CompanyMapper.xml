<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yc.taokefu.mapper.CompanyMapper">
	<select id="addcompany" resultType="java.util.List" parameterType="User">
		insert into company (comp_id,comp_email) values(${comp_id},'${comp_email}')
	</select>
	
	<resultMap type="PaginationBean" id="PaginationBeanMap">
		<collection property="rows" column="{pageSize=pageSize,currPage=currPage}" ofType="Company" select="getCompany" />
	</resultMap>

	<!-- 后台用户页面加载 -->
	<select id="findPartCompanys" parameterType="PaginationBean" resultMap="PaginationBeanMap">
		select count(1) total, ceil(count(1) / ${pageSize})
		totalPage,${pageSize} pageSize,${currPage} currPage from company
	</select>


	<select id="getCompany" resultType="Company">
		select * from (select n.*,rownum
		rn from
		(select * from company order by 1) n where
		${pageSize}*${currPage} >= rownum)
		where rn >
		${pageSize}*(${currPage}-1)
	</select>
	
	<!-- 后台公司添加 -->
	<insert id="BackCompanyAdd" parameterType="Company">
		insert into company
		(comp_id,comp_name,comp_fullname,comp_logo,comp_territory,comp_state,comp_phone,comp_email,comp_link,comp_city,comp_scale,comp_introduce,comp_introduces,comp_attestation,tag_name)
		values(company_sql.nextval,#{comp_name},#{comp_fullname},#{comp_logo},#{comp_territory},#{comp_state},#{comp_phone},#{comp_email},#{comp_link},#{comp_city},#{comp_scale},#{comp_introduce},#{comp_introduces},#{comp_attestation},#{tag_name})
	</insert>
	
	<!-- 后台公司修改 -->
	<update id="BackCompanyEdit" parameterType="Company">
		update company
		<set>
			<if test="comp_id != null">
				comp_id = #{comp_id},
			</if>
			<if test="comp_name != null">
				comp_name = #{comp_name},
			</if>
			<if test="comp_fullname != null">
				comp_fullname = #{comp_fullname},
			</if>
			<if test="comp_logo != null">
				comp_logo = #{comp_logo},
			</if>
			<if test="comp_territory != null">
				comp_territory = #{comp_territory},
			</if>
			<if test="comp_state != null">
				comp_state = #{comp_state},
			</if>
			<if test="comp_phone != null">
				comp_phone = #{comp_phone},
			</if>
			<if test="comp_email != null">
				comp_email = #{comp_email},
			</if>
			<if test="comp_link != null">
				comp_link = #{comp_link},
			</if>
			<if test="comp_city != null">
				comp_city = #{comp_city},
			</if>
			<if test="comp_scale != null">
				comp_scale = #{comp_scale},
			</if>
			<if test="comp_introduce != null">
				comp_introduce = #{comp_introduce},
			</if>
			<if test="comp_introduces != null">
				comp_introduces = #{comp_introduces},
			</if>
			<if test="comp_attestation != null">
				comp_attestation = #{comp_attestation},
			</if>
			<if test="tag_name != null">
				tag_name = #{tag_name}
			</if>
		</set>
		where comp_id = #{comp_id}
	</update>
	
	<!-- 后台公司删除 -->
	<delete id="BackCompanyDelete" parameterType="String">
		delete from company
		where comp_id=#{id}
	</delete>
	
	<!-- 后台公司搜索 -->
	<select id="BackCompanysearch" parameterType="Company" resultType="Company">
		select * from company 
		<if test="comp_search !=null and comp_search !='-0'">where ${find_comp}='${comp_search}'</if>
	</select>
</mapper>