<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yc.taokefu.mapper.UserMapper">

	<select id="addOtherUser" resultType="java.util.List"
		parameterType="Qqlogin">
		insert into tkfuser (us_id,us_name)
		values(#{openId},#{nickname})
	</select>

	<resultMap type="PaginationBean" id="PaginationBeanMap">
		<collection property="rows"
			column="{pageSize=pageSize,currPage=currPage}" ofType="User" select="getUser" />
	</resultMap>

	<!-- 213 -->
	<select id="findPartUsers" parameterType="PaginationBean"
		resultMap="PaginationBeanMap">
		select count(1) total, ceil(count(1) / ${pageSize})
		totalPage,${pageSize} pageSize,${currPage} currPage from tkfuser
	</select>


	<select id="getUser" resultType="User">
		select * from (select n.*,rownum
		rn from
		(select * from tkfuser order by 1) n where
		${pageSize}*${currPage} >= rownum)
		where rn >
		${pageSize}*(${currPage}-1)
	</select>


	<!-- 添加 -->
	<!-- 用户信息 -->
	<select id="addUser" resultType="java.util.List" parameterType="User">
		insert into tkfuser (us_id,us_email) values(${us_id},'${us_email}')
	</select>

	<select id="insertUser" parameterType="UserAll" resultType="Integer">
		insert into tkfuser values(tkfuser_sql.nextval
		<if test="us_name==null or us_name==''">,''</if>
		<if test="us_name!=null">,'${us_name}'</if>
		<if test="us_picpath==null or us_picpath ==''">,''</if>
		<if test="us_picpath!=null">,'${us_picpath}'</if>
		<if test="us_intro==null or us_intro ==''">,''</if>
		<if test="us_intro!=null">,'${us_intro}'</if>
		<if test="us_sex==null or us_sex ==''">,''</if>
		<if test="us_sex!=null">,'${us_sex}'</if>
		<if test="us_educationa==null or us_educationa ==''">,''</if>
		<if test="us_educationa!=null">,'${us_educationa}'</if>
		<if test="us_work_year==null or us_work_year ==''">,''</if>
		<if test="us_work_year!=null">,'${us_work_year}'</if>
		<if test="us_phone==null or us_phone ==''">,''</if>
		<if test="us_phone!=null">,'${us_phone}'</if>
		<if test="us_email==null or us_email ==''">,''</if>
		<if test="us_email!=null">,'${us_email}'</if>
		<if test="openId==null or openId ==''">,''</if>
		<if test="openId!=null">,'${openId}'</if>
		)
	</select>
	<!-- 简历信息 -->
	<select id="insertUsResume" parameterType="User" resultType="java.util.List">
		insert into usResume values(usResume_sql.nextval
		<if test="tkf_id==null or tkf_id==''">,''</if>
		<if test="tkf_id!=null">,'${tkf_id}'</if>
		<if test="c_id==null or c_id==''">,''</if>
		<if test="c_id!=null">,'${c_id}'</if>
		<if test="usr_name==null or usr_name==''">,''</if>
		<if test="usr_name!=null">,'${usr_name}'</if>
		<if test="usr_state==null or usr_state==''">,''</if>
		<if test="usr_state!=null">,'${usr_state}'</if>
		<if test="hj_name==null or hj_name==''">,''</if>
		<if test="hj_name!=null">,'${hj_name}'</if>
		<if test="hj_city==null or hj_city==''">,''</if>
		<if test="hj_city!=null">,'${hj_city}'</if>
		<if test="hj_min_salary==null or hj_min_salary==''">,''</if>
		<if test="hj_min_salary!=null">,'${hj_min_salary}'</if>
		<if test="hj_max_salary==null or hj_max_salary==''">,''</if>
		<if test="hj_max_salary!=null">,'${hj_max_salary}'</if>
		<if test="hj_nature ==null or hj_nature ==''">,''</if>
		<if test="hj_nature != null">,'${hj_nature}'</if>
		<if test="des_content == null or des_content ==''">,''</if>
		<if test="des_content!=null">,'${des_content}'</if>
		)
	</select>
	<!-- 作品信息 -->
	<select id="insertSucceed" parameterType="UserAll" resultType="java.util.List">
		insert into succeed values(succeed_sql.nextval
		<if test="tkf_id==null or tkf_id==''">,''</if>
		<if test="tkf_id!=null">,'${tkf_id}'</if>
		<if test="suc_name ==null or suc_name ==''">,''</if>
		<if test="suc_name !=null">,'${suc_name}'</if>
		<if test="suc_link ==null or suc_link ==''">,''</if>
		<if test="suc_link !=null">,'${suc_link}'</if>
		)
	</select>
	<!-- 经历 -->
	<select id="insertExperience" parameterType="UserAll"
		resultType="java.util.List">
		insert into experience values(experience_job_sql.nextval
		<if test="tkf_id==null or tkf_id==''">,''</if>
		<if test="tkf_id!=null">,'${tkf_id}'</if>
		<if test="exp_company_name ==null or exp_company_name ==''">,''</if>
		<if test="exp_company_name !=null">,'${exp_company_name}'</if>
		<if test="exp_job_name ==null or exp_job_name ==''">,''</if>
		<if test="exp_job_name !=null">,'${exp_job_name}'</if>
		<if test="exp_start_year ==null or exp_start_year ==''">,''</if>
		<if test="exp_start_year !=null">,'${exp_start_year}'</if>
		<if test="exp_end_year ==null or exp_end_year ==''">,''</if>
		<if test="exp_end_year !=null">,'${exp_end_year}'</if>
		)
	</select>
	<!--学历信息 -->
	<select id="insertEducationa" parameterType="UserAll"
		resultType="java.util.List">
		insert into educationa values(educationa_sql.nextval
		<if test="tkf_id==null or tkf_id==''">,''</if>
		<if test="tkf_id!=null">,'${tkf_id}'</if>
		<if test="edu_shool_name ==null or edu_shool_name ==''">,''</if>
		<if test="edu_shool_name !=null">,'${edu_shool_name}'</if>
		<if test="edu_major ==null or edu_major ==''">,''</if>
		<if test="edu_major !=null">,'${edu_major}'</if>
		<if test="edu_educationa ==null or edu_educationa ==''">,''</if>
		<if test="edu_educationa !=null">,'${edu_educationa}'</if>
		<if test="edu_start_year ==null or edu_start_year ==''">,''</if>
		<if test="edu_start_year !=null">,'${edu_start_year}'</if>
		<if test="edu_end_year ==null or edu_end_year ==''">,''</if>
		<if test="edu_end_year !=null">,'${edu_end_year}'</if>
		)
	</select>
	<!-- 收藏信息 -->
	<select id="insertCollect" parameterType="UserAll" resultType="java.util.List">
		insert into collect values(collect_sql.nextval
		<if test="tkf_id==null or tkf_id==''">,''</if>
		<if test="tkf_id!=null">,'${tkf_id}'</if>
		<if test="col_job_id ==null or col_job_id ==''">,''</if>
		<if test="col_job_id !=null">,'${col_job_id}'</if>
		)
	</select>
	<!-- 订阅信息 -->
	<select id="insertTake" parameterType="UserAll" resultType="java.util.List">
		insert into take values(take_job_sql.nextval
		<if test="tkf_id==null or tkf_id==''">,''</if>
		<if test="tkf_id!=null">,'${tkf_id}'</if>
		<if test="tak_job_id ==null or tak_job_id ==''">,''</if>
		<if test="tak_job_id !=null">,'${tak_job_id}'</if>
		<if test="tak_email ==null or tak_email ==''">,''</if>
		<if test="tak_email !=null">,'${tak_email}'</if>
		<if test="tak_time ==null or tak_time ==''">,''</if>
		<if test="tak_time !=null">,'${tak_time}'</if>
		<if test="tak_job_name ==null or tak_job_name ==''">,''</if>
		<if test="tak_job_name!=null">,'${tak_job_name}'</if>
		<if test="tak_job_city ==null or tak_job_city ==''">,''</if>
		<if test="tak_job_city !=null">,'${tak_job_city}'</if>
		<if test="tak_state ==null or tak_state ==''">,''</if>
		<if test="tak_state !=null">,'${tak_state}'</if>
		<if test="tak_territory ==null or tak_territory ==''">,''</if>
		<if test="tak_territory !=null">,'${tak_territory}'</if>
		<if test="tak_min_salary ==null or tak_min_salary ==''">,''</if>
		<if test="tak_min_salary !=null">,'${tak_min_salary}'</if>
		<if test="tak_max_salary ==null or tak_max_salary ==''">,''</if>
		<if test="tak_max_salary !=null">,'${tak_max_salary}'</if>
		)
	</select>


	<!-- 查询用户信息 -->
	<select id="findUser" parameterType="UserAll" resultType="UserAll">
		select
		* from tkfuser where us_id=#{us_id}
	</select>
	<!-- 查询简历信息 -->
	<select id="findUsResume" parameterType="UserAll" resultType="java.util.List">
		select * from usResume where usr_id=#{usr_id}
	</select>
	<!-- 查询作品信息 -->
	<select id="findSucceed" parameterType="UserAll" resultType="User">
		select * from succeed where suc_id=#{suc_id}
	</select>
	<!-- 查询经历 -->
	<select id="findExperience" parameterType="UserAll" resultType="User">
		select * from experience where exp_id=#{exp_id}
	</select>
	<!-- 查询学历信息 -->
	<select id="findEducationa" parameterType="UserAll" resultType="User">
		select * from educationa where edu_id=#{edu_id}
	</select>
	<!-- 查询收藏信息 -->
	<select id="findCollect" parameterType="UserAll" resultType="User">
		select * from collect where col_id=#{col_id}
	</select>
	<!-- 查询订阅信息 -->
	<select id="findTake" parameterType="UserAll" resultType="User">
		select
		* from take where tak_id=#{tak_id}
	</select>




	<!-- 修改用户信息 -->
	<select id="modifiUser" parameterType="UserAll" resultType="User">
		update tkfuser 
		<set>
		<if test="us_name !=null">us_name='${us_name}',</if>
		<if test="us_picpath !=null">us_picpath='${us_picpath}',</if>
		<if test="us_intro !=null">us_intro='${us_intro}',</if>
		<if test="us_sex !=null">us_sex='${us_sex}',</if>
		<if test="us_educationa !=null">us_educationa='${us_educationa}',</if>
		<if test="us_work_year !=null">us_work_year='${us_work_year}',</if>
		<if test="us_phone !=null">us_phone='${us_phone}',</if>
		</set>
		where  
		<trim><if test="us_id !=null">us_id=${us_id}</if> 
		<if test="us_email !=null"> us_email='${us_email}'</if>
		<if test="openId !=null"> openId='${openId}'</if></trim>
		
	</select>
	<!-- 简历信息 -->
	<select id="modifiUsResume" parameterType="UserAll" resultType="User">
		select * from usResume where usr_id=${usr_id}
	</select>
	<!-- 作品信息 -->
	<select id="modifiSucceed" parameterType="UserAll" resultType="User">
		select * from succeed where suc_id=${suc_id}
	</select>
	<!-- 经历 -->
	<select id="modifiExperience" parameterType="UserAll"
		resultType="User">
		select * from experience where
		exp_id=${exp_id}
	</select>
	<!-- 学历信息 -->
	<select id="modifiEducationa" parameterType="UserAll"
		resultType="User">
		select * from educationa where edu_id=${edu_id}
	</select>
	<!-- 收藏信息 -->
	<select id="modifiCollect" parameterType="UserAll" resultType="User">
		select * from collect where col_id=${col_id}
	</select>
	<!-- 订阅信息 -->
	<select id="modifiTake" parameterType="UserAll" resultType="User">
		select
		* from take where tak_id=${tak_id}
	</select>

</mapper>