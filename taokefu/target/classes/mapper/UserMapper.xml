<?xml version="1.0" encoding="UTF-8" ?>
<!DOCTYPE mapper
PUBLIC "-//mybatis.org//DTD Mapper 3.0//EN"
"http://mybatis.org/dtd/mybatis-3-mapper.dtd">
<mapper namespace="com.yc.taokefu.mapper.UserMapper">
	<insert id="addUser"   parameterType="User" >
		insert into tkfuser (us_id,us_email) values(${us_id},'${us_email}')
	</insert>

	<!-- 后台用户添加 -->
	<insert id="BackUserAdd" parameterType="User">
		insert into tkfuser (us_id,us_name,us_picpath,us_sex,us_educationa,us_work_year,us_phone,us_email,us_intro)
		values(tkfuser_sql.nextval,#{us_name},#{us_picpath},#{us_sex},#{us_educationa},#{us_work_year},#{us_phone},#{us_email},#{us_intro})
	</insert>
	
	<!-- 后台用户修改 -->
	<update id="BackUserEdit" parameterType="User">
			update tkfuser
		<set>
			<if test="us_id != null">
				us_id = #{us_id},
			</if>
			<if test="us_name != null">
				us_name = #{us_name},
			</if>
			<if test="us_picpath != null">
				us_picpath = #{us_picpath},
			</if>
			<if test="us_sex != null">
				us_sex = #{us_sex},
			</if>
			<if test="us_educationa != null">
				us_educationa = #{us_educationa},
			</if>
			<if test="us_work_year != null">
				us_work_year = #{us_work_year},
			</if>
			<if test="us_phone != null">
				us_phone = #{us_phone},
			</if>
			<if test="us_email != null">
				us_email = #{us_email},
			</if>
			<if test="us_intro != null">
				us_intro = #{us_intro}
			</if>
		</set>
		where us_id = #{us_id}
	</update>
	
	<!-- 后台用户删除 -->
	<delete id="BackUserDelete" parameterType="String">
		delete from tkfuser where us_id=#{id}
	</delete>
	
	<resultMap type="PaginationBean" id="PaginationBeanMap">
		<collection property="rows" column="{pageSize=pageSize,currPage=currPage}" ofType="User" select="getUser"/>
	</resultMap>
	
	<!-- 213 -->
	<select id="findPartUsers" parameterType="PaginationBean" resultMap="PaginationBeanMap">
		select count(1) total, ceil(count(1) / ${pageSize}) totalPage,${pageSize} pageSize,${currPage} currPage from tkfuser
	</select>
	
	<select id="getUser" resultType="User">
		select * from (select n.*,rownum rn from 
		(select * from tkfuser order by 1) n where ${pageSize}*${currPage} >= rownum)
		where rn > ${pageSize}*(${currPage}-1)
	</select>
	
</mapper>